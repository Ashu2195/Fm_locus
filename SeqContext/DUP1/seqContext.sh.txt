bedtools slop -i DUP1_HDPs_minus1.bed -g Gallus_gallus.GRCg6a.dna_sm.toplevel.fa.fai -b 10|bedtools getfasta -fi Gallus_gallus.GRCg6a.dna_sm.toplevel.fa -bed stdin|awk '$0~">"{name=$1;pos=1}$0!~">"{pos_in=1;while(nuc=substr($0,pos_in,1)){pos_out=pos_in+1;while(nuc==substr($0,pos_out,1)){pos++;pos_out++};len=pos_out-pos_in;if(len>1){print name,$0,nuc"*"len,pos-len+1,pos};pos_in=pos_out;pos++}}'|sed 's/ /\t/g'|awk '{print "20",$4,$5,$0}'|sed 's/ /\t/g'|bedtools intersect -a stdin -b midpoint.bed -wao

bedtools slop -i DUP1_HDPs_minus1.bed -g Gallus_gallus.GRCg6a.dna_sm.toplevel.fa.fai -b 10|bedtools getfasta -fi Gallus_gallus.GRCg6a.dna_sm.toplevel.fa -bed stdin > DUP1_10Mers.fasta

bedtools slop -i DUP1_HDPs_minus1.bed -g Gallus_gallus.GRCg6a.dna_sm.toplevel.fa.fai -b 10|bedtools getfasta -fi Gallus_gallus.GRCg6a.dna_sm.toplevel.fa -bed stdin|awk '$0~">"{name=$1;pos=1}$0!~">"{pos_in=1;while(nuc=substr($0,pos_in,1)){pos_out=pos_in+1;while(nuc==substr($0,pos_out,1)){pos++;pos_out++};len=pos_out-pos_in;if(len>1){print name,$0,nuc"*"len,pos-len+1,pos};pos_in=pos_out;pos++}}'|sed 's/ /\t/g'|awk '{print "20",$4,$5,$0}'|sed 's/ /\t/g' > DUP1_10Mers.homoPoly.bed

bedtools slop -i DUP1_HDPs_minus1.bed -g Gallus_gallus.GRCg6a.dna_sm.toplevel.fa.fai -b 10|bedtools getfasta -fi Gallus_gallus.GRCg6a.dna_sm.toplevel.fa -bed stdin|awk '$0~">"{name=$1;pos=1}$0!~">"{pos_in=1;while(nuc=substr($0,pos_in,1)){pos_out=pos_in+1;while(nuc==substr($0,pos_out,1)){pos++;pos_out++};len=pos_out-pos_in;if(len>1){print name,$0,nuc"*"len,pos-len+1,pos};pos_in=pos_out;pos++}}'|sed 's/ /\t/g'|awk '{print "20",$4,$5,$0}'|sed 's/ /\t/g'|bedtools intersect -a stdin -b midpoint.bed -wao|awk '$12==1{print $0}' > DUP1_10Mers.homoPoly.HDP.bed
